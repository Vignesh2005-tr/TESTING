<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ASCEND SUPPORT FORM</title>
    <link rel="icon" href="image/ascend.gif" type="image/gif">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="stlye.css">
</head>

<body>

<h1>ASCEND APPLICATION FORM</h1>

<div class="logo-box">
    <img src="image/ascend.gif" alt="Ascend Logo">
    <hr>
</div>

<form id="Customer">

    <table border="1">

        <tr>
            <th colspan="2">ASCEND PURCHASE FORM</th>
        </tr>

        <tr>
            <td>IC NAME</td>
            <td><input type="text" name="pname" placeholder="ENTER YOUR NAME" required></td>
        </tr>

        <tr>
            <td>DISCORD NAME</td>
            <td><input type="text" name="dname" placeholder="ENTER YOUR DISCORD NAME" required></td>
        </tr>

        <tr>
            <td>UID</td>
            <td><input type="text" name="uid" placeholder="ENTER YOUR UID" required></td>
        </tr>

        <tr>
            <td>SELECTED PACK / VEHICLE</td>
            <td><input type="text" id="selectedPack" name="selectedPack" readonly></td>
        </tr>

        <tr>
            <td>AMOUNT</td>
            <td><input type="text" id="amountField" name="amount" readonly></td>
        </tr>

        <tr>
            <td>PAYMENT PROOF</td>
            <td><input type="file" name="paymentProof" accept="image/*,.pdf" required></td>
        </tr>

    </table>

<center>

        <div class="custom-form">
        <input class="form-submit" type="submit" value="Submit">
        <input class="form-submit" type="reset" value="Clear">
    </div>
</center>

</form>

<center>

<!-- QR CODE -->
<div class="vehicle-card">
    <h1>QR Code</h1>
    <img src="image/QR.jpg" alt="QR Code">
    </div>

</center>

<!-- SCRIPT SECTION -->

<script>
document.addEventListener("DOMContentLoaded", function () {

    // Get data from URL
    const urlParams = new URLSearchParams(window.location.search);
    const vehicle = urlParams.get("vehicle");
    const pack = urlParams.get("pack");
    const price = urlParams.get("price");

    if (vehicle) {
        document.getElementById("selectedPack").value = vehicle;
    }

    if (pack) {
        document.getElementById("selectedPack").value = pack;
    }

    if (price) {
        document.getElementById("amountField").value = "â‚¹" + price;
    }

});


// DISCORD WEBHOOK SUBMIT

document.getElementById("Customer").addEventListener("submit", function(e) {
    e.preventDefault();

    const pname = document.querySelector("[name='pname']").value;
    const dname = document.querySelector("[name='dname']").value;
    const uid = document.querySelector("[name='uid']").value;
    const pack = document.getElementById("selectedPack").value;
    const amount = document.getElementById("amountField").value;
    const paymentProofFile = document.querySelector("[name='paymentProof']").files[0];

    const webhookURL = "https://discord.com/api/webhooks/1469751200604881039/KAQFQHeeCiGgpaCZlduoq1vAPRiWZ6FxrI3FGPGtiln7d5KC9gL40ARADuoRhpZhQ1Dc"; // ðŸ”´ PASTE YOUR WEBHOOK HERE

    const data = {
        embeds: [{
            content: "<@&1461606860372316377> <@&1461606866810437702>",
            title: "ðŸ›’ ASCEND PURCHASE",
            color: 16711935,
            fields: [
                { name: "IC Name", value: pname, inline: true },
                { name: "Discord Name", value: dname, inline: true },
                { name: "UID", value: uid, inline: false },
                { name: "Pack / Vehicle", value: pack || "Not Provided", inline: true },
                { name: "Amount", value: amount || "Not Provided", inline: true },
                { name: "Payment Proof", value: paymentProofFile ? paymentProofFile.name : "Not Provided", inline: false }
            ],
            footer: {
                text: "ASCEND SYSTEM"
            },
            timestamp: new Date()
        }]
    };

    const formData = new FormData();
    formData.append('payload_json', JSON.stringify(data));
    if (paymentProofFile) {
        formData.append('file', paymentProofFile);
    }

    fetch(webhookURL, {
        method: "POST",
        body: formData
    })
    .then(response => {
        if (response.ok) {
            alert("Application Submitted Successfully!");
            document.getElementById("Customer").reset();
        } else {
            alert("Error sending to Discord.");
        }
    })
    .catch(error => {
        alert("Webhook error.");
    });

});
</script>

</body>
</html>
