<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ASCEND Payment Form</title>
  <link rel="icon" href="image/ascend.gif" type="image/gif">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1 style="text-align:center;">ASCEND PURCHASE FORM</h1>

<div style="text-align:center; margin:20px; color:#00f7ff;">
  <h3>Selected Vehicle: <span id="selectedVehicle">None</span></h3>
  <h3>Price: â‚¹<span id="selectedPrice">0</span></h3>
</div>

<form id="Customer" enctype="multipart/form-data">

  <label>IC NAME: <input type="text" name="pname" required></label><br>
  <label>GPAY NAME: <input type="text" name="gpay_name" required></label><br>
  <label>UPLOAD PAYMENT PROOF: <input type="file" name="payment_proof" accept="image/*" required></label><br>

  <label>PAYMENT METHOD:
    <select id="method" name="method" required>
      <option value="">-- Select Method --</option>
      <option value="GPAY">GPAY / UPI</option>
      <option value="Paytm">Paytm</option>
    </select>
  </label><br><br>

  <div style="text-align:center; background:#111; padding:20px; border-radius:10px;">
    <h3 style="color:#00f7ff;">ðŸ’³ GPAY PAYMENT</h3>
    <div id="amountDisplay" style="font-size:1.5rem; color:#ff00ff;">Amount: â‚¹0</div>

    <button type="button" onclick="openPaymentModal()">ðŸ’° Pay with GPAY</button>
    <p>UPI: <span style="color:#00f7ff;">gajaraj1628@okhdfcbank</span></p>
    <label><input type="checkbox" id="paymentConfirm"> âœ… I have completed payment</label>
  </div>

  <!-- Payment Modal -->
  <div id="paymentModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); align-items:center; justify-content:center;">
    <div style="background:#1a1a1a; padding:30px; border-radius:15px; max-width:400px; margin:auto;">
      <h2 style="color:#00f7ff;">ðŸ›’ ASCEND PAYMENT</h2>
      <h1 id="modalAmount" style="color:#ff00ff;">â‚¹0</h1>
      <div id="qrCode"></div>
      <p>Pay â‚¹<span id="modalAmountNum">0</span> via any UPI app</p>
      <button type="button" onclick="initiatePayment()">ðŸ’³ Open UPI Payment</button>
      <button type="button" onclick="closePaymentModal()">âœ– Close</button>
    </div>
  </div>

  <br>
  <label><input type="checkbox" id="agree"> I confirm payment & accept rules</label><br><br>
  <input type="submit" id="submitBtn" value="Submit" disabled>
  <div id="successMsg" style="color:lime;"></div>
  <div id="errorMsg" style="color:red;"></div>
  <div id="cooldownMsg" style="color:orange;"></div>
</form>

<script src="form.js"></script>
<script>
// Read URL params
const params = new URLSearchParams(window.location.search);
const vehicle = params.get("vehicle");
const price = params.get("price");

if (vehicle) document.getElementById("selectedVehicle").textContent = vehicle;
if (price) {
  document.getElementById("selectedPrice").textContent = price;
  document.getElementById("amountDisplay").textContent = "Amount: â‚¹" + price;
}

// Auto-open UPI deep link
function initiatePayment() {
  const upiID = "gajaraj1628@okhdfcbank";
  const amount = price || "0";
  const upiString = `upi://pay?pa=${upiID}&pn=ASCEND&am=${amount}&cu=INR`;
  window.location.href = upiString;
}

// Modal controls
function openPaymentModal() {
  document.getElementById("modalAmount").textContent = "â‚¹" + (price || "0");
  document.getElementById("modalAmountNum").textContent = price || "0";
  generateQRCode(price || "0");
  document.getElementById("paymentModal").style.display = "flex";
}
function closePaymentModal() {
  document.getElementById("paymentModal").style.display = "none";
}
function generateQRCode(amount) {
  const upiID = "gajaraj1628@okhdfcbank";
  const qrContainer = document.getElementById("qrCode");
  qrContainer.innerHTML = "";
  const upiString = `upi://pay?pa=${upiID}&pn=ASCEND&am=${amount}&cu=INR`;
  const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(upiString)}`;
  const img = document.createElement("img");
  img.src = qrUrl;
  img.alt = "UPI QR";
  qrContainer.appendChild(img);
}
</script>
</body>
</html>
